# üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Products API

## üìã –û–±–∑–æ—Ä

–ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –¥–ª—è Products API —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π, CI/CD –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –û–∫—Ä—É–∂–µ–Ω–∏—è

- **üîß Development** - –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- **üöÄ Staging** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º  
- **üè≠ Production** - –ø—Ä–æ–¥–∞–∫—à–µ–Ω –æ–∫—Ä—É–∂–µ–Ω–∏–µ

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **PostgreSQL** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Redis** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **API** - Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- **Nginx** - reverse proxy (production)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–µ—Ä–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

```bash
# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ development –æ–∫—Ä—É–∂–µ–Ω–∏–∏
make deploy

# –ò–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
./deploy.sh dev
```

### 2. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤–æ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö

```bash
# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤–æ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö
make deploy-all

# –ò–ª–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
make deploy-staging
make deploy-prod
```

## üîß –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# Development
make deploy              # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ dev
./deploy.sh dev         # –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç

# Staging  
make deploy-staging     # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ staging
./deploy.sh staging     # –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç

# Production
make deploy-prod        # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ production
./deploy.sh prod        # –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç

# –í—Å–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
make deploy-all         # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤–µ–∑–¥–µ
```

### CI/CD –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–ª–Ω—ã–π CI/CD –ø—Ä–æ—Ü–µ—Å—Å
make ci-cd              # Development
make ci-cd-staging      # Staging
make ci-cd-prod         # Production

# –ò–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
./scripts/ci-cd.sh dev main
./scripts/ci-cd.sh staging main
./scripts/ci-cd.sh prod main
```

## üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
make env-status

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–æ–≤
make monitor

# –õ–æ–≥–∏ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
make env-logs
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
make env-stop

# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
make diagnose
```

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### Development

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - Go, Docker, Redis
2. **–°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** - `go build`
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è Swagger** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. **–ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ** - `go run main.go`
5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏**

### Staging/Production

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
2. **–°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
3. **–°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞**
4. **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Docker Compose**
5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ health checks**
6. **–í–∞–ª–∏–¥–∞—Ü–∏—è endpoints**

## üìÅ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Development
- `config.env` - –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `docker-compose.yml` - –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

### Staging
- `config.staging.env` - staging –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `docker-compose.staging.yml` - staging —Å–µ—Ä–≤–∏—Å—ã

### Production
- `config.prod.env` - production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `docker-compose.prod.yml` - production —Å–µ—Ä–≤–∏—Å—ã

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=password
DB_NAME=products_db

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# JWT
JWT_SECRET=your-secret-key

# –°–µ—Ä–≤–µ—Ä
SERVER_PORT=8080
```

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ

```env
# –û–∫—Ä—É–∂–µ–Ω–∏–µ
ENVIRONMENT=development
LOG_LEVEL=debug

# SSL
DB_SSL_MODE=disable
REDIS_TTL=3600
```

## üê≥ Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

```bash
# –°–±–æ—Ä–∫–∞ —Å —Ç–µ–≥–æ–º –≤–µ—Ä—Å–∏–∏
docker build -t products-api:latest .

# –°–±–æ—Ä–∫–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏
docker build -t products-api:v1.0.0 .
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
# Development
docker-compose up -d

# Staging
docker-compose -f docker-compose.staging.yml up -d

# Production
docker-compose -f docker-compose.prod.yml up -d
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ Git
make update

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
make update-deps

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
make deploy
```

### –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
make env-stop

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
git pull origin main

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
make deploy
```

## üö® –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç

–°–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö:

```bash
# –ü—Ä–∏ –æ—à–∏–±–∫–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# 1. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
# 2. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—Å–∏—é
# 3. –õ–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É
```

### –†—É—á–Ω–æ–π –æ—Ç–∫–∞—Ç

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
make env-stop

# –í–æ–∑–≤—Ä–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
git checkout HEAD~1

# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
make deploy
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# Development
tail -f app.log

# Staging
docker-compose -f docker-compose.staging.yml logs -f api

# Production
docker-compose -f docker-compose.prod.yml logs -f api
```

### Health checks

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl http://localhost:8080/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Swagger
curl http://localhost:8080/swagger/index.html

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
curl http://localhost:8080/api/v1/products
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Production —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–°–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏** –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. **SSL/TLS** —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
3. **Firewall** –ø—Ä–∞–≤–∏–ª–∞
4. **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```env
# –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –≤ Git!
JWT_SECRET=very-long-random-string-here
DB_PASSWORD=very-strong-password
REDIS_PASSWORD=strong-redis-password
```

## üöÄ CI/CD Pipeline

### –≠—Ç–∞–ø—ã

1. **Git –ø—Ä–æ–≤–µ—Ä–∫–∞** - —Å—Ç–∞—Ç—É—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - `make test`
3. **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞** - `make lint`
4. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–≥–∞** - –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
5. **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ
6. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - —Å—Ç–∞—Ç—É—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
7. **–û—á–∏—Å—Ç–∫–∞** - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

```bash
# Git hooks –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
.git/hooks/pre-commit    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
.git/hooks/post-commit   # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
```

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

```yaml
# docker-compose.prod.yml
api:
  deploy:
    replicas: 3
    resources:
      limits:
        memory: 512M
        cpus: '0.5'
```

### Load Balancer

```yaml
# nginx/nginx.conf
upstream api_servers {
    server api:8080;
    server api2:8080;
    server api3:8080;
}
```

## üÜò Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ü–æ—Ä—Ç –∑–∞–Ω—è—Ç**
   ```bash
   lsof -i :8080 | xargs kill -9
   ```

2. **Docker –Ω–µ –∑–∞–ø—É—â–µ–Ω**
   ```bash
   open -a Docker
   ```

3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞**
   ```bash
   docker-compose up -d postgres
   ```

4. **Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω**
   ```bash
   make redis-start
   ```

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
make diagnose

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
make check

# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
make env-status
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **Makefile** - –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- **deploy.sh** - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- **scripts/ci-cd.sh** - CI/CD –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- **docker-compose.*.yml** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–∫—Ä—É–∂–µ–Ω–∏–π

## üéØ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** –≤ staging –ø–µ—Ä–µ–¥ production
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–π
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
4. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ** –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–∞–¥–∞—á–∏
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ** –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

üöÄ **–ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é!** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `make deploy` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞. 