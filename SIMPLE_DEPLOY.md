# üöÄ –ü—Ä–æ—Å—Ç–æ–π –î–µ–ø–ª–æ–π –±–µ–∑ Healthcheck

## –ü—Ä–æ–±–ª–µ–º–∞
```
Container products_redis_prod  Error
Container products_postgres_prod  Error
dependency failed to start: container products_redis_prod is unhealthy
```

## –†–µ—à–µ–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑—É–µ–º **–ø—Ä–æ—Å—Ç–æ–π –¥–µ–ø–ª–æ–π** —Å –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –±–µ–∑ healthcheck.

## üéØ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç deploy-simple

### ‚úÖ **–°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Å—Ç—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**
- –§–∞–π–ª `docker-compose-simple.yml` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **–ë–µ–∑ healthcheck** –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- **–ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** (password, dev-secret-key)
- **–ü—Ä–æ—Å—Ç—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** –±–µ–∑ —É—Å–ª–æ–≤–∏–π

### ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**
```yaml
# PostgreSQL
POSTGRES_PASSWORD: password
POSTGRES_HOST_AUTH_METHOD: trust

# Redis
command: redis-server --appendonly yes  # –ë–µ–∑ –ø–∞—Ä–æ–ª—è

# API
DB_PASSWORD: password
JWT_SECRET: dev-secret-key-change-in-production
```

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ:
```bash
make deploy-simple ENV=prod SERVER=45.12.229.112 USER=root
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:
```bash
./scripts/deploy-simple.sh prod 45.12.229.112 root
```

## üìã –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

### 1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –û—á–∏—Å—Ç–∫–∞ Docker (volumes, networks)

### 2. **–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**
- `docker-compose-simple.yml` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ü—Ä–æ—Å—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑ healthcheck
- –ë–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 3. **–ó–∞–ø—É—Å–∫**
- –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –û–∂–∏–¥–∞–Ω–∏–µ 60 —Å–µ–∫—É–Ω–¥
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

### 4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
- PostgreSQL: `pg_isready`
- Redis: `redis-cli ping`
- API: `wget /health`

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:
- ‚úÖ PostgreSQL –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å `password`
- ‚úÖ Redis –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –ø–∞—Ä–æ–ª—è
- ‚úÖ API –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –±–∞–∑–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- ‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://45.12.229.112:8082

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤:
```bash
ssh root@45.12.229.112 "cd /opt/api-go && docker-compose -f docker-compose-simple.yml ps"
```

### –õ–æ–≥–∏:
```bash
ssh root@45.12.229.112 "cd /opt/api-go && docker-compose -f docker-compose-simple.yml logs -f"
```

### –¢–µ—Å—Ç API:
```bash
curl http://45.12.229.112:8082/health
```

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
- –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å healthcheck
- –ü—Ä–æ—Å—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞**
- –ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –ë–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –õ–µ–≥–∫–æ –æ—Ç–ª–∞–¥–∏—Ç—å

### ‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å**
- –ù–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è healthcheck
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
- –ë—ã—Å—Ç—Ä–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
- `password` –≤–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è
- `dev-secret-key` –≤–º–µ—Å—Ç–æ production —Å–µ–∫—Ä–µ—Ç–∞
- `trust` –¥–ª—è PostgreSQL –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### üìù **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `.env` —Ñ–∞–π–ª—ã
- –ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –¢–æ–ª—å–∫–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. **–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ API endpoints

### 2. **–£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
- –ò–∑–º–µ–Ω–∏—Ç–µ `password` –Ω–∞ —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å
- –û–±–Ω–æ–≤–∏—Ç–µ `JWT_SECRET` –Ω–∞ production
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é

### 3. **–í–æ–∑–≤—Ä–∞—Ç healthcheck**
- –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ healthcheck –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ñ–∞–π–ª–µ
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å `docker-compose.prod.yml`
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose-simple.yml` –¥–ª—è production

## üõ†Ô∏è Troubleshooting

### –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
ssh root@45.12.229.112 "cd /opt/api-go && docker-compose -f docker-compose-simple.yml logs -f"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
ssh root@45.12.229.112 "free -h && df -h"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker
ssh root@45.12.229.112 "docker info"
```

### –ï—Å–ª–∏ API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
ssh root@45.12.229.112 "cd /opt/api-go && docker-compose -f docker-compose-simple.yml ps"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
ssh root@45.12.229.112 "netstat -tlnp | grep :8082"

# –¢–µ—Å—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
ssh root@45.12.229.112 "cd /opt/api-go && docker exec \$(docker-compose -f docker-compose-simple.yml ps -q api) wget -qO- http://localhost:8080/health"
```

## üìö –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –ü—Ä–æ—Å—Ç–æ–π –¥–µ–ø–ª–æ–π
make deploy-simple ENV=prod SERVER=45.12.229.112 USER=root

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
make check-config

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
ssh root@45.12.229.112 "cd /opt/api-go && docker-compose -f docker-compose-simple.yml logs -f"

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
ssh root@45.12.229.112 "cd /opt/api-go && docker-compose -f docker-compose-simple.yml restart"
```

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ deploy-simple –∫–æ–≥–¥–∞:**
- –ù—É–∂–µ–Ω –±—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫
- –ü—Ä–æ–±–ª–µ–º—ã —Å healthcheck
- –û—Ç–ª–∞–¥–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### ‚ùå **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è:**
- Production —Å –≤—ã—Å–æ–∫–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –°–∏—Å—Ç–µ–º —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –î–µ–ø–ª–æ–π
make deploy-simple ENV=prod SERVER=45.12.229.112 USER=root

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞
ssh root@45.12.229.112 "cd /opt/api-go && docker-compose -f docker-compose-simple.yml ps"

# 3. –¢–µ—Å—Ç API
curl http://45.12.229.112:8082/health

# 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
ssh root@45.12.229.112 "cd /opt/api-go && docker-compose -f docker-compose-simple.yml logs -f"
```

## üéâ –ò—Ç–æ–≥

**deploy-simple** - —ç—Ç–æ –±—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º —Å healthcheck. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞, –∞ –∑–∞—Ç–µ–º —É–ª—É—á—à–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è production. 